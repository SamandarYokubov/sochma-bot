# üöÄ Sochma Bot Setup Guide

This guide will walk you through setting up and running the Sochma Bot step by step.

## üìã Prerequisites

Before you begin, make sure you have:

- **Node.js 18+** installed ([Download here](https://nodejs.org/))
- **MongoDB** running locally or access to MongoDB Atlas
- **Telegram Bot Token** from [@BotFather](https://t.me/botfather)

## üéØ Quick Start (Recommended)

### Option 1: Automated Setup
```bash
# Run the quick start script
./quick-start.sh
```

### Option 2: Manual Setup
```bash
# 1. Install dependencies
npm install

# 2. Run setup wizard
node setup.js

# 3. Start the bot
npm run dev
```

## üìù Detailed Setup Instructions

### Step 1: Create a Telegram Bot

1. Open Telegram and search for [@BotFather](https://t.me/botfather)
2. Send `/newbot` command
3. Choose a name for your bot (e.g., "Sochma Bot")
4. Choose a username (e.g., "sochma_bot")
5. Copy the bot token you receive

### Step 2: Set up MongoDB

#### Option A: Local MongoDB (Recommended for Development)

**macOS (with Homebrew):**
```bash
brew tap mongodb/brew
brew install mongodb-community
brew services start mongodb-community
```

**Ubuntu/Debian:**
```bash
sudo apt update
sudo apt install -y mongodb
sudo systemctl start mongodb
sudo systemctl enable mongodb
```

**Windows:**
1. Download MongoDB from [mongodb.com](https://www.mongodb.com/try/download/community)
2. Install and start the MongoDB service

#### Option B: MongoDB Atlas (Cloud)

1. Go to [MongoDB Atlas](https://www.mongodb.com/atlas)
2. Create a free account
3. Create a new cluster
4. Create a database user
5. Get your connection string (looks like: `mongodb+srv://username:password@cluster.mongodb.net/sochma_bot`)

#### Option C: Docker MongoDB

```bash
docker run -d --name mongodb -p 27017:27017 mongo:latest
```

### Step 3: Configure Environment Variables

#### Automated Configuration
```bash
node setup.js
```

#### Manual Configuration
Edit the `.env` file with your settings:

```env
# Bot Configuration
BOT_TOKEN=1234567890:ABCdefGHIjklMNOpqrsTUVwxyz
BOT_USERNAME=your_bot_username

# Database Configuration
MONGODB_URI=mongodb://localhost:27017/sochma_bot
# OR for Atlas: mongodb+srv://username:password@cluster.mongodb.net/sochma_bot

# Application Configuration
NODE_ENV=development
LOG_LEVEL=info

# Sochma Platform API (Optional for basic functionality)
SOCHMA_API_URL=https://api.sochma.com
SOCHMA_API_KEY=your_api_key_here

# Security (Auto-generated by setup script)
JWT_SECRET=your_jwt_secret_here
ENCRYPTION_KEY=your_encryption_key_here
```

### Step 4: Start the Bot

#### Development Mode
```bash
npm run dev
```

#### Production Mode
```bash
npm start
```

## üß™ Testing Your Bot

1. Open Telegram and search for your bot username
2. Send `/start` command
3. Follow the setup prompts
4. Test other commands like `/help`, `/profile`, `/search`

## üîß Configuration Options

### Environment Variables

| Variable | Description | Required | Default |
|----------|-------------|----------|---------|
| `BOT_TOKEN` | Telegram bot token from @BotFather | ‚úÖ Yes | - |
| `BOT_USERNAME` | Your bot's username | ‚úÖ Yes | - |
| `MONGODB_URI` | MongoDB connection string | ‚úÖ Yes | - |
| `NODE_ENV` | Environment (development/production) | ‚ùå No | development |
| `LOG_LEVEL` | Logging level (error/warn/info/debug) | ‚ùå No | info |
| `SOCHMA_API_URL` | Sochma platform API URL | ‚ùå No | https://api.sochma.com |
| `SOCHMA_API_KEY` | Sochma platform API key | ‚ùå No | - |
| `JWT_SECRET` | JWT signing secret | ‚úÖ Yes | Auto-generated |
| `ENCRYPTION_KEY` | Data encryption key | ‚úÖ Yes | Auto-generated |

### Logging Configuration

Logs are stored in the `logs/` directory:
- `combined.log` - All application logs
- `error.log` - Error logs only

To change log level, set `LOG_LEVEL` in your `.env` file:
- `error` - Only errors
- `warn` - Warnings and errors
- `info` - Info, warnings, and errors (default)
- `debug` - All logs including debug information

## üöÄ Production Deployment

### Using PM2 (Recommended)

```bash
# Install PM2 globally
npm install -g pm2

# Start the bot with PM2
pm2 start src/index.js --name sochma-bot

# Save PM2 configuration
pm2 save

# Setup PM2 to start on boot
pm2 startup
```

### Using Docker

```bash
# Build Docker image
docker build -t sochma-bot .

# Run container
docker run -d --name sochma-bot --env-file .env sochma-bot
```

### Using systemd (Linux)

1. Create service file: `/etc/systemd/system/sochma-bot.service`
2. Enable and start the service:
```bash
sudo systemctl enable sochma-bot
sudo systemctl start sochma-bot
```

## üîç Troubleshooting

### Common Issues

#### 1. Bot not responding
- ‚úÖ Check if bot token is correct
- ‚úÖ Verify bot is running (check logs)
- ‚úÖ Make sure you're messaging the correct bot username

#### 2. Database connection errors
- ‚úÖ Verify MongoDB is running
- ‚úÖ Check MongoDB URI format
- ‚úÖ Ensure database user has proper permissions

#### 3. Module not found errors
- ‚úÖ Run `npm install` to install dependencies
- ‚úÖ Check Node.js version (18+ required)

#### 4. Permission errors
- ‚úÖ Make sure scripts are executable: `chmod +x setup.js quick-start.sh`
- ‚úÖ Check file permissions in the project directory

### Debug Mode

Enable debug logging for troubleshooting:

```env
LOG_LEVEL=debug
NODE_ENV=development
```

### Health Checks

The bot provides several health check endpoints:
- Database connection status
- Bot status and statistics
- API connectivity (if configured)

## üìä Monitoring

### Log Files
- Check `logs/combined.log` for general application logs
- Check `logs/error.log` for error-specific logs

### Bot Statistics
- Use `/stats` command in Telegram to see user statistics
- Monitor database for user growth and activity

## üîí Security Best Practices

1. **Never commit `.env` file** to version control
2. **Use strong secrets** for JWT_SECRET and ENCRYPTION_KEY
3. **Enable rate limiting** (configured by default)
4. **Regular updates** - Keep dependencies updated
5. **Monitor logs** for suspicious activity

## üÜò Getting Help

If you encounter issues:

1. **Check the logs** in the `logs/` directory
2. **Enable debug mode** by setting `LOG_LEVEL=debug`
3. **Verify all prerequisites** are installed and running
4. **Check the troubleshooting section** above
5. **Create an issue** on GitHub with detailed error information

## üéâ Success!

Once everything is set up correctly, you should see:
```
‚úÖ Sochma Bot is now running!
üìä Environment: development
ü§ñ Bot Username: @your_bot_username
üì° Mode: Polling
```

Your bot is now ready to connect investors and buyers! üöÄ
